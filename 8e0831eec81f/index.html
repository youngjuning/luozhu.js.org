<!DOCTYPE html><html lang=zh-CN data-theme=light><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>一个前端工程师的 Docker 学习笔记 | 洛竹的博客</title><meta name=author content=洛竹><meta name=copyright content=洛竹><meta name=format-detection content="telephone=no"><meta name=theme-color content=#ffffff><meta name=description content="Docker 是个划时代的开源项目，它彻底释放了计算虚拟化的威力，极大提高了应用的维护效率，降低了云计算应用开发的成本！使用 Docker，可以让应用的部署、测试和分发都变得前所未有的高效和轻松！ 无论是应用开发者、运维人员、还是其他信息技术从业人员，都有必要认识和掌握 Docker，节约有限的生命。 本文是笔者以一个前端工程师的视角学习 Docker 过程中的笔记，如果对您有所帮助，荣幸之至。"><meta property=og:type content=article><meta property=og:title content="一个前端工程师的 Docker 学习笔记"><meta property=og:url content=https://youngjuning.js.org/8e0831eec81f/index.html><meta property=og:site_name content=洛竹的博客><meta property=og:description content="Docker 是个划时代的开源项目，它彻底释放了计算虚拟化的威力，极大提高了应用的维护效率，降低了云计算应用开发的成本！使用 Docker，可以让应用的部署、测试和分发都变得前所未有的高效和轻松！ 无论是应用开发者、运维人员、还是其他信息技术从业人员，都有必要认识和掌握 Docker，节约有限的生命。 本文是笔者以一个前端工程师的视角学习 Docker 过程中的笔记，如果对您有所帮助，荣幸之至。"><meta property=og:locale content=zh_CN><meta property=og:image content=https://i.loli.net/2020/03/31/UI9JSTCENRvqDwY.png><meta property=article:published_time content=2020-03-30T16:23:31.000Z><meta property=article:modified_time content=2023-04-01T09:12:58.739Z><meta property=article:author content=洛竹><meta property=article:tag content=笔记><meta property=article:tag content=Docker><meta name=twitter:card content=summary><meta name=twitter:image content=https://pbs.twimg.com/profile_images/1628559000953565186/HVtTFoKv_x96.jpg><meta name=twitter:creator content=@luozhu2021><meta name=twitter:site content=https://twitter.com/luozhu2021><link rel="shortcut icon" href=https://picbed.qunarzz.com/af8c84d2c24a6b971153e6620f3218ad.png><link rel=canonical href=https://youngjuning.js.org/8e0831eec81f/index.html><link rel=preconnect href=//cdn.jsdelivr.net><link rel=preconnect href=//www.google-analytics.com crossorigin=""><link rel=preconnect href=//hm.baidu.com><link rel=preconnect href=//www.clarity.ms><link rel=preconnect href=//busuanzi.ibruce.info><meta><link rel=stylesheet href=/css/index.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css media=print onload='this.media="all"'><script async=async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-7962287588031867",enable_page_level_ads:"true"})</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?df1911ed1429a8432517d427138fbb79",document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)}()</script><script async=async src="https://www.googletagmanager.com/gtag/js?id=G-M7KEMBRVPJ"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-M7KEMBRVPJ")</script><script>!function(t,e,n,a,c,r){t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},(c=e.createElement(a)).async=1,c.src="https://www.clarity.ms/tag/fytne6knad",(r=e.getElementsByTagName(a)[0]).parentNode.insertBefore(c,r)}(window,document,"clarity","script")</script><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!1,languages:{hits_empty:"找不到您查询的内容：${query}"}},translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"繁",msgToSimplifiedChinese:"簡"},noticeOutdate:{limitDay:365,position:"top",messagePrev:"It has been",messageNext:"days since the last update, the content of the article may be outdated."},highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:400},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!0,post:!0},runtime:"天",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:{limitCount:50,languages:{author:"作者: 洛竹",link:"链接: ",source:"来源: 洛竹的博客",info:"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体",cht_to_chs:"你已切换为简体",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#49b1f5",bgDark:"#1f1f1f",position:"bottom-left"},source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css"}},isPhotoFigcaption:!0,islazyload:!1,isAnchor:!0,percent:{toc:!0,rightside:!0}}</script><script id=config-diff>var GLOBAL_CONFIG_SITE={title:"一个前端工程师的 Docker 学习笔记",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2023-04-01 17:12:58"}</script><noscript><style type=text/css>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,a){0!==a&&(a=864e5*a,t={value:t,expiry:(new Date).getTime()+a},localStorage.setItem(e,JSON.stringify(t)))},get:function(e){var t=localStorage.getItem(e);if(t){t=JSON.parse(t);if(!((new Date).getTime()>t.expiry))return t.value;localStorage.removeItem(e)}}},e.getScript=o=>new Promise((t,e)=>{const a=document.createElement("script");a.src=o,a.async=!0,a.onerror=e,a.onload=a.onreadystatechange=function(){var e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,t())},document.head.appendChild(a)}),e.getCSS=(o,n=!1)=>new Promise((t,e)=>{const a=document.createElement("link");a.rel="stylesheet",a.href=o,n&&(a.id=n),a.onerror=e,a.onload=a.onreadystatechange=function(){var e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,t())},document.head.appendChild(a)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};e=saveToLocal.get("theme"),"dark"===e?activateDarkMode():"light"===e&&activateLightMode(),e=saveToLocal.get("aside-status");void 0!==e&&("hide"===e?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel=stylesheet href=https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css media=print onload='this.media="all"'><link rel=stylesheet href=https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css media=print onload='this.media="all"'><meta name=generator content="Hexo 6.3.0"><link rel=alternate href=/atom.xml title=洛竹的博客 type=application/atom+xml></head><body><div id=sidebar><div id=menu-mask></div><div id=sidebar-menus><div class="avatar-img is-center"><img src=https://picbed.qunarzz.com/af8c84d2c24a6b971153e6620f3218ad.png onerror='onerror=null,src="/img/friend_404.gif"' alt=avatar></div><div class="sidebar-site-data site-data is-center"><a href=/archives/ ><div class=headline>文章</div><div class=length-num>111</div></a><a href=/tags/ ><div class=headline>标签</div><div class=length-num>238</div></a><a href=/categories/ ><div class=headline>分类</div><div class=length-num>36</div></a></div><hr><div class=menus_items><div class=menus_item><a class=site-page href=/ ><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class=menus_item><a class="site-page group" href=javascript:void(0); rel="external nofollow noreferrer"><i class="fa-fw fa-fw fas fa-lines-leaning"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class=menus_item_child><li><a class="site-page child" href=/categories/ ><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href=/tags/ ><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href=/archives/ ><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href=/random/ ><i class="fa-fw fas fa-random"></i><span> 随机</span></a></li></ul></div><div class=menus_item><a class=site-page href=/album/ ><i class="fa-fw fas fa-images"></i><span> 相册</span></a></div><div class=menus_item><a class="site-page group" href=javascript:void(0); rel="external nofollow noreferrer"><i class="fa-fw fas fa-star"></i><span> 导航</span><i class="fas fa-chevron-down"></i></a><ul class=menus_item_child><li><a class="site-page child" href=/frontend/ ><i class="fa-fw fas fa-code"></i><span> 前端导航</span></a></li><li><a class="site-page child" href=/tool/ ><i class="fa-fw fas fa-cog"></i><span> 工具导航</span></a></li><li><a class="site-page child" href=/oversea/ ><i class="fa-fw fas fa-hand-holding-usd"></i><span> 跨境导航</span></a></li><li><a class="site-page child" href=/yingxiao/ ><i class="fa-fw fas fa-cog"></i><span> 营销导航</span></a></li><li><a class="site-page child" href=/webmaster/ ><i class="fa-fw fas fa-user-tie"></i><span> 站长导航</span></a></li><li><a class="site-page child" href=/wangzhuan/ ><i class="fa-fw fas fa-money-bill-wave"></i><span> 网赚导航</span></a></li><li><a class="site-page child" href=/vpn/ ><i class="fa-fw fas fa-wifi"></i><span> 科学上网</span></a></li></ul></div><div class=menus_item><a class="site-page group" href=javascript:void(0); rel="external nofollow noreferrer"><i class="fa-fw fas fa-wine-glass-alt"></i><span> 社交</span><i class="fas fa-chevron-down"></i></a><ul class=menus_item_child><li><a class="site-page child" href=/friends/ ><i class="fa-fw fas fa-link"></i><span> 友人</span></a></li><li><a class="site-page child" target=_blank rel="noopener external nofollow noreferrer" href=https://travellings.vercel.app/ ><i class="fa-fw fas fa-paper-plane"></i><span> 开往</span></a></li><li><a class="site-page child" href=/movies/ ><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page child" href=/books/ ><i class="fa-fw fas fa-book"></i><span> 读书</span></a></li><li><a class="site-page child" href=/bangumi/ ><i class="fa-fw fas fa-tv"></i><span> 追番</span></a></li></ul></div><div class=menus_item><a class="site-page group" href=javascript:void(0); rel="external nofollow noreferrer"><i class="fa-fw fas fa-heart"></i><span> 我的</span><i class="fas fa-chevron-down"></i></a><ul class=menus_item_child><li><a class="site-page child" target=_blank rel="noopener external nofollow noreferrer" href=https://luozhu2021.blogspot.com/ ><i class="fa-fw fas fa-book"></i><span> 日记</span></a></li><li><a class="site-page child" href=/projects/ ><i class="fa-fw fab fa-github"></i><span> 项目</span></a></li><li><a class="site-page child" href=/gallery/ ><i class="fa-fw fas fa-images"></i><span> 图床</span></a></li><li><a class="site-page child" href=/atom.xml><i class="fa-fw fas fa-rss"></i><span> 订阅</span></a></li><li><a class="site-page child" href=/about/ ><i class="fa-fw fas fa-spa"></i><span> 关于</span></a></li></ul></div></div></div></div><div class=post id=body-wrap><header class="post-bg fixed" id=page-header style=background-image:url(https://i.loli.net/2020/03/31/UI9JSTCENRvqDwY.png)><nav id=nav><span id=blog-info><a href=/ title=洛竹的博客><img class=site-icon src=https://picbed.qunarzz.com/af8c84d2c24a6b971153e6620f3218ad.png><span class=site-name>洛竹的博客</span></a></span><div id=menus><div id=search-button><a class="site-page social-icon search" href=javascript:void(0); rel="external nofollow noreferrer"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class=menus_items><div class=menus_item><a class=site-page href=/ ><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class=menus_item><a class="site-page group" href=javascript:void(0); rel="external nofollow noreferrer"><i class="fa-fw fa-fw fas fa-lines-leaning"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class=menus_item_child><li><a class="site-page child" href=/categories/ ><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href=/tags/ ><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href=/archives/ ><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href=/random/ ><i class="fa-fw fas fa-random"></i><span> 随机</span></a></li></ul></div><div class=menus_item><a class=site-page href=/album/ ><i class="fa-fw fas fa-images"></i><span> 相册</span></a></div><div class=menus_item><a class="site-page group" href=javascript:void(0); rel="external nofollow noreferrer"><i class="fa-fw fas fa-star"></i><span> 导航</span><i class="fas fa-chevron-down"></i></a><ul class=menus_item_child><li><a class="site-page child" href=/frontend/ ><i class="fa-fw fas fa-code"></i><span> 前端导航</span></a></li><li><a class="site-page child" href=/tool/ ><i class="fa-fw fas fa-cog"></i><span> 工具导航</span></a></li><li><a class="site-page child" href=/oversea/ ><i class="fa-fw fas fa-hand-holding-usd"></i><span> 跨境导航</span></a></li><li><a class="site-page child" href=/yingxiao/ ><i class="fa-fw fas fa-cog"></i><span> 营销导航</span></a></li><li><a class="site-page child" href=/webmaster/ ><i class="fa-fw fas fa-user-tie"></i><span> 站长导航</span></a></li><li><a class="site-page child" href=/wangzhuan/ ><i class="fa-fw fas fa-money-bill-wave"></i><span> 网赚导航</span></a></li><li><a class="site-page child" href=/vpn/ ><i class="fa-fw fas fa-wifi"></i><span> 科学上网</span></a></li></ul></div><div class=menus_item><a class="site-page group" href=javascript:void(0); rel="external nofollow noreferrer"><i class="fa-fw fas fa-wine-glass-alt"></i><span> 社交</span><i class="fas fa-chevron-down"></i></a><ul class=menus_item_child><li><a class="site-page child" href=/friends/ ><i class="fa-fw fas fa-link"></i><span> 友人</span></a></li><li><a class="site-page child" target=_blank rel="noopener external nofollow noreferrer" href=https://travellings.vercel.app/ ><i class="fa-fw fas fa-paper-plane"></i><span> 开往</span></a></li><li><a class="site-page child" href=/movies/ ><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page child" href=/books/ ><i class="fa-fw fas fa-book"></i><span> 读书</span></a></li><li><a class="site-page child" href=/bangumi/ ><i class="fa-fw fas fa-tv"></i><span> 追番</span></a></li></ul></div><div class=menus_item><a class="site-page group" href=javascript:void(0); rel="external nofollow noreferrer"><i class="fa-fw fas fa-heart"></i><span> 我的</span><i class="fas fa-chevron-down"></i></a><ul class=menus_item_child><li><a class="site-page child" target=_blank rel="noopener external nofollow noreferrer" href=https://luozhu2021.blogspot.com/ ><i class="fa-fw fas fa-book"></i><span> 日记</span></a></li><li><a class="site-page child" href=/projects/ ><i class="fa-fw fab fa-github"></i><span> 项目</span></a></li><li><a class="site-page child" href=/gallery/ ><i class="fa-fw fas fa-images"></i><span> 图床</span></a></li><li><a class="site-page child" href=/atom.xml><i class="fa-fw fas fa-rss"></i><span> 订阅</span></a></li><li><a class="site-page child" href=/about/ ><i class="fa-fw fas fa-spa"></i><span> 关于</span></a></li></ul></div></div><div id=toggle-menu><a class=site-page href=javascript:void(0); rel="external nofollow noreferrer"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id=post-info><h1 class=post-title>一个前端工程师的 Docker 学习笔记<a class=post-edit-link href="https://github.com/youngjuning/youngjuning.github.io/edit/main/source/_posts/一个前端工程师的 Docker 学习笔记.md" rel="external nofollow noreferrer" title=编辑 target=_blank><i class="fas fa-pencil-alt"></i></a></h1><div id=post-meta><div class=meta-firstline><span class=post-meta-date><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class=post-meta-label>发表于</span><time datetime=2020-03-30T16:23:31.000Z title="发表于 2020-03-31 00:23:31">2020-03-31</time></span><span class=post-meta-categories><span class=post-meta-separator>|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class=post-meta-categories href=/categories/%E8%BF%90%E7%BB%B4/ >运维</a></span></div><div class=meta-secondline><span class=post-meta-separator>|</span><span class=post-meta-wordcount><i class="far fa-file-word fa-fw post-meta-icon"></i><span class=post-meta-label>字数总计:</span><span class=word-count>5.9k</span><span class=post-meta-separator>|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class=post-meta-label>阅读时长:</span><span>21分钟</span></span><span class=post-meta-separator>|</span><span class=post-meta-pv-cv id="" data-flag-title="一个前端工程师的 Docker 学习笔记"><i class="far fa-eye fa-fw post-meta-icon"></i><span class=post-meta-label>阅读量:</span><span id=busuanzi_value_page_pv><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class=layout id=content-inner><div id=post><article class=post-content id=article-container><p>Docker 是个划时代的开源项目，它彻底释放了计算虚拟化的威力，极大提高了应用的维护效率，降低了云计算应用开发的成本！使用 Docker，可以让应用的部署、测试和分发都变得前所未有的高效和轻松！</p><p>无论是应用开发者、运维人员、还是其他信息技术从业人员，都有必要认识和掌握 Docker，节约有限的生命。</p><p>本文是笔者以一个前端工程师的视角学习 Docker 过程中的笔记，如果对您有所帮助，荣幸之至。</p><h1 id=基础入门><a href=#基础入门 class=headerlink title=基础入门></a>基础入门</h1><p><strong>Docker</strong> 使用 <code>Google</code> 公司推出的 <a target=_blank rel="noopener external nofollow noreferrer" href=https://golang.org/ >Go 语言</a> 进行开发实现，基于 <code>Linux</code> 内核的 <a target=_blank rel="noopener external nofollow noreferrer" href=https://zh.wikipedia.org/wiki/Cgroups>cgroup</a>，<a target=_blank rel="noopener external nofollow noreferrer" href=https://en.wikipedia.org/wiki/Linux_namespaces>namespace</a>，以及 <a target=_blank rel="noopener external nofollow noreferrer" href=https://docs.docker.com/storage/storagedriver/overlayfs-driver/ >OverlayFS</a> 类的 <a target=_blank rel="noopener external nofollow noreferrer" href=https://en.wikipedia.org/wiki/Union_mount>Union FS</a> 等技术，对进程进行封装隔离，属于 <a target=_blank rel="noopener external nofollow noreferrer" href=https://en.wikipedia.org/wiki/Operating-system-level_virtualization>操作系统层面的虚拟化技术</a>。由于隔离的进程独立于宿主和其它的隔离的进程，因此也称其为容器。最初实现是基于 <a target=_blank rel="noopener external nofollow noreferrer" href=https://linuxcontainers.org/lxc/introduction/ >LXC</a>，从 0.7 版本以后开始去除 <code>LXC</code>，转而使用自行开发的 <a target=_blank rel="noopener external nofollow noreferrer" href=https://github.com/docker/libcontainer>libcontainer</a>，从 1.11 开始，则进一步演进为使用 <a target=_blank rel="noopener external nofollow noreferrer" href=https://github.com/opencontainers/runc>runC</a> 和 <a target=_blank rel="noopener external nofollow noreferrer" href=https://github.com/containerd/containerd>containerd</a>。</p><h2 id=概念><a href=#概念 class=headerlink title=概念></a>概念</h2><h3 id=DevOps><a href=#DevOps class=headerlink title=DevOps></a><strong>DevOps</strong></h3><p>DevOps（<strong>Dev</strong>elopment和<strong>Op</strong>erations的组合词）是一种重视软件开发人员（Dev）和IT运维技术人员（Ops）之间沟通合作的文化、运动或惯例。透过自动化“软件交付”和“架构变更”的流程，来使得构建、测试、发布软件能够更加地快捷、频繁和可靠。</p><p>DevOps 的引入能对产品交付、<a target=_blank rel="noopener external nofollow noreferrer" href=https://zh.wikipedia.org/wiki/%E6%B5%8B%E8%AF%95>测试</a>、功能开发和<a target=_blank rel="noopener external nofollow noreferrer" href=https://zh.wikipedia.org/wiki/%E8%BB%9F%E9%AB%94%E7%B6%AD%E8%AD%B7>维护</a>（包括曾经罕见但如今已屡见不鲜的“<a target=_blank rel="noopener external nofollow noreferrer" href=https://zh.wikipedia.org/wiki/Hot_fix>热补丁</a>”）起到意义深远的影响。在缺乏 DevOps 能力的组织中，开发与运营之间存在着信息“鸿沟”。例如运营人员要求更好的可靠性和安全性，开发人员则希望<a target=_blank rel="noopener external nofollow noreferrer" href=https://zh.wikipedia.org/wiki/%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD>基础设施</a>响应更快，而业务用户的需求则是更快地将更多的特性发布给最终用户使用。这种信息鸿沟就是最常出问题的地方。</p><h3 id=容器><a href=#容器 class=headerlink title=容器></a>容器</h3><p>容器有效地将由单个操作系统管理的资源划分到孤立的组中，以更好地在孤立的组之间平衡有冲突的资源使用需求。与虚拟化相比，这样既不需要指令级模拟，也不需要即时编译。容器可以在核心 CPU 本地运行指令，而不需要任何专门的解释机制。此外，也避免了准虚拟化（para-virtualization）和系统调用替换中的复杂性。</p><h3 id=虚拟化><a href=#虚拟化 class=headerlink title=虚拟化></a>虚拟化</h3><p>在计算机技术中，虚拟化是一种资源管理技术，是将计算机中的各种实体资源，如服务器、网络、内存及存储等，予以抽象、转换后呈现出来，打破实体结构间的不可切割的障碍，使用户可以用比原来的组态更好的方式来应用这些资源。</p><h3 id=Docker-与虚拟机比较><a href=#Docker-与虚拟机比较 class=headerlink title="Docker 与虚拟机比较"></a>Docker 与虚拟机比较</h3><table><thead><tr><th>特性</th><th>容器</th><th>虚拟机</th></tr></thead><tbody><tr><td>启动</td><td>秒级</td><td>分钟级</td></tr><tr><td>硬盘使用</td><td>一般为 <code>MB</code></td><td>一般为 <code>GB</code></td></tr><tr><td>性能</td><td>接近原生</td><td>弱于</td></tr><tr><td>系统支持量</td><td>单机支持上千个容器</td><td>一般几十个</td></tr></tbody></table><p>如下图，虚拟机是在硬件层面实现虚拟化，需要额外的虚拟机管理应用和虚拟机操作系统层。Docker容器是在操作系统层面上实现虚拟化，直接复用本地主机的操作系统，因此更加轻量级。</p><p><img src=https://i.loli.net/2020/03/31/mZiyHL2kGAgrMFx.png></p><h3 id=Docker核心概念><a href=#Docker核心概念 class=headerlink title=Docker核心概念></a>Docker核心概念</h3><h4 id=镜像（Image）><a href=#镜像（Image） class=headerlink title=镜像（Image）></a>镜像（Image）</h4><p>我们都知道，操作系统分为内核和用户空间。对于 Linux 而言，内核启动后，会挂载 <code>root</code> 文件系统为其提供用户空间支持。而 Docker 镜像（Image），就相当于是一个 <code>root</code> 文件系统。比如官方镜像 <code>ubuntu:18.04</code> 就包含了完整的一套 Ubuntu 18.04 最小系统的 <code>root</code> 文件系统。</p><p>Docker 镜像是一个特殊的文件系统，除了提供容器运行时所需的程序、库、资源、配置等文件外，还包含了一些为运行时准备的一些配置参数（如匿名卷、环境变量、用户等）。镜像不包含任何动态数据，其内容在构建之后也不会被改变。</p><p><strong>分层存储</strong></p><p>因为镜像包含操作系统完整的 <code>root</code> 文件系统，其体积往往是庞大的，因此在 Docker 设计时，就充分利用 <a target=_blank rel="noopener external nofollow noreferrer" href=https://en.wikipedia.org/wiki/Union_mount>Union FS</a> 的技术，将其设计为分层存储的架构。所以严格来说，镜像并非是像一个 ISO 那样的打包文件，镜像只是一个虚拟的概念，其实际体现并非由一个文件组成，而是由一组文件系统组成，或者说，由多层文件系统联合组成。</p><p>镜像构建时，会一层层构建，前一层是后一层的基础。每一层构建完就不会再发生改变，后一层上的任何改变只发生在自己这一层。比如，删除前一层文件的操作，实际不是真的删除前一层的文件，而是仅在当前层标记为该文件已删除。在最终容器运行的时候，虽然不会看到这个文件，但是实际上该文件会一直跟随镜像。因此，在构建镜像的时候，需要额外小心，每一层尽量只包含该层需要添加的东西，任何额外的东西应该在该层构建结束前清理掉。</p><p>分层存储的特征还使得镜像的复用、定制变的更为容易。甚至可以用之前构建好的镜像作为基础层，然后进一步添加新的层，以定制自己所需的内容，构建新的镜像。</p><h4 id=容器（Container）><a href=#容器（Container） class=headerlink title=容器（Container）></a>容器（Container）</h4><p>镜像（<code>Image</code>）和容器（<code>Container</code>）的关系，就像是面向对象程序设计中的 <code>类</code> 和 <code>实例</code> 一样，镜像是静态的定义，容器是镜像运行时的实体。容器可以被创建、启动、停止、删除、暂停等。</p><p>容器的实质是进程，但与直接在宿主执行的进程不同，容器进程运行于属于自己的独立的 <a target=_blank rel="noopener external nofollow noreferrer" href=https://en.wikipedia.org/wiki/Linux_namespaces>命名空间</a>。因此容器可以拥有自己的 <code>root</code> 文件系统、自己的网络配置、自己的进程空间，甚至自己的用户 ID 空间。容器内的进程是运行在一个隔离的环境里，使用起来，就好像是在一个独立于宿主的系统下操作一样。这种特性使得容器封装的应用比直接在宿主运行更加安全。也因为这种隔离的特性，很多人初学 Docker 时常常会混淆容器和虚拟机。</p><p>前面讲过镜像使用的是分层存储，容器也是如此。每一个容器运行时，是以镜像为基础层，在其上创建一个当前容器的存储层，我们可以称这个为容器运行时读写而准备的存储层为 <strong>容器存储层</strong>。</p><p>容器存储层的生存周期和容器一样，容器消亡时，容器存储层也随之消亡。因此，任何保存于容器存储层的信息都会随容器删除而丢失。</p><p>按照 Docker 最佳实践的要求，容器不应该向其存储层内写入任何数据，容器存储层要保持无状态化。所有的文件写入操作，都应该使用 <a target=_blank rel="noopener external nofollow noreferrer" href=https://vuepress.mirror.docker-practice.com/data_management/volume.html>数据卷（Volume）</a>、或者绑定宿主目录，在这些位置的读写会跳过容器存储层，直接对宿主（或网络存储）发生读写，其性能和稳定性更高。</p><p>数据卷的生存周期独立于容器，容器消亡，数据卷不会消亡。因此，使用数据卷后，容器删除或者重新运行之后，数据却不会丢失。</p><h4 id=仓库注册服务器（Registry）><a href=#仓库注册服务器（Registry） class=headerlink title=仓库注册服务器（Registry）></a>仓库注册服务器（Registry）</h4><p>一个 <strong>Docker Registry</strong> 中可以包含多个 <strong>仓库</strong>（<code>Repository</code>）；每个仓库可以包含多个 <strong>标签</strong>（<code>Tag</code>）；每个标签对应一个镜像。</p><p>通常，一个仓库会包含同一个软件不同版本的镜像，而标签就常用于对应该软件的各个版本。我们可以通过 <code>&lt;仓库名&gt;:&lt;标签&gt;</code> 的格式来指定具体是这个软件哪个版本的镜像。如果不给出标签，将以 <code>latest</code> 作为默认标签。</p><p>以 <a target=_blank rel="noopener external nofollow noreferrer" href=https://hub.docker.com/_/ubuntu>Ubuntu 镜像</a> 为例，<code>ubuntu</code> 是仓库的名字，其内包含有不同的版本标签，如，<code>16.04</code>, <code>18.04</code>。我们可以通过 <code>ubuntu:16.04</code>，或者 <code>ubuntu:18.04</code> 来具体指定所需哪个版本的镜像。如果忽略了标签，比如 <code>ubuntu</code>，那将视为 <code>ubuntu:latest</code>。</p><p>仓库名经常以 <em>两段式路径</em> 形式出现，比如 <code>jwilder/nginx-proxy</code>，前者往往意味着 Docker Registry 多用户环境下的用户名，后者则往往是对应的软件名。但这并非绝对，取决于所使用的具体 Docker Registry 的软件或服务。</p><p><strong>公有 Docker Registry：</strong></p><ul><li><a target=_blank rel="noopener external nofollow noreferrer" href=https://hub.docker.com/ >Docker Hub</a></li><li><a target=_blank rel="noopener external nofollow noreferrer" href=https://c.163.com/hub#/m/library/ >网易云镜像服务</a></li><li><a target=_blank rel="noopener external nofollow noreferrer" href=https://hub.daocloud.io/ >DaoCloud 镜像市场</a></li><li><a target=_blank rel="noopener external nofollow noreferrer" href=https://cr.console.aliyun.com/ >aliyun镜像库</a></li></ul><p><strong>私有 Docker Registry：</strong></p><ul><li><a target=_blank rel="noopener external nofollow noreferrer" href=https://vuepress.mirror.docker-practice.com/repository/nexus3_registry.html>Sonatype Nexus</a></li><li><a target=_blank rel="noopener external nofollow noreferrer" href=https://github.com/goharbor/harbor>Harbor</a></li></ul><h3 id=守护进程-daemon><a href=#守护进程-daemon class=headerlink title="守护进程 daemon"></a>守护进程 daemon</h3><p>在一个多任务的电脑操作系统中，守护进程（daemon）是一种在后台执行的电脑程序。此类程序会被以进程的形式初始化。守护进程程序的名称通常以字母”d“结尾：例如，<code>syslogd</code> 就是指管理系统日志的守护进程。</p><p>通常，守护进程没有任何存在的父进程（即PPID&#x3D;1），且在 UNIX 系统进程层级中直接位于 init 之下。守护进程程序通常通过如下方法是自己成为守护进程：对一个子进程进行 fork，然后使其父进程立即终止，使得这个子进程能在 init 下运行。这种方法通常被称为”脱壳“。</p><p>系统通常在启动时一同引导守护进程。守护进程为对网络请求，硬件活动等进行响应，或其他通过某些任务对其他应用程序的请求进行回应提供支持。守护进程也能够对硬件进行配置（如某些Linux系统上的devfsd），运行计划任务（例如cron），以及运行其他任务。</p><p>在 DOS 环境中，此类应用程序被称为驻留程序（TSR）。在 Windows 系统中，由称为 Windows服务的应用程序来履行守护进程的职责。</p><p>在原本的 Mac OS 系统中，此类应用程序被称为”extensions“。而作为 Unux-like 的 Mac OS X 有守护进程。</p><h2 id=安装配置><a href=#安装配置 class=headerlink title=安装配置></a>安装配置</h2><ul><li>操作系统：Linux ubuntu18 4.15.0-91-generic，通过 <code>uname -a</code> 查看</li><li>docker-ce镜像：<a target=_blank rel="noopener external nofollow noreferrer" href="https://developer.aliyun.com/mirror/docker-ce?spm=a2c6h.13651102.0.0.52471b11cIp2pH">https://developer.aliyun.com/mirror/docker-ce?spm=a2c6h.13651102.0.0.52471b11cIp2pH</a></li></ul><h3 id=卸载旧版本><a href=#卸载旧版本 class=headerlink title=卸载旧版本></a>卸载旧版本</h3><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line><span class="meta prompt_">$ </span><span class=language-bash>apt remove docker docker-engine docker.io containerd runc</span></span><br></pre></td></tr></table></figure><h3 id=通过软件包安装><a href=#通过软件包安装 class=headerlink title=通过软件包安装></a>通过软件包安装</h3><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br></pre></td><td class=code><pre><span class=line><span class="meta prompt_"># </span><span class=language-bash>step 1: 安装必要的一些系统工具</span></span><br><span class=line>sudo apt-get update</span><br><span class=line>sudo apt-get -y install apt-transport-https ca-certificates curl gnupg-agent pass software-properties-common</span><br><span class=line><span class="meta prompt_"># </span><span class=language-bash>step 2: 安装GPG证书</span></span><br><span class=line>curl -fsSL https://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg | sudo apt-key add -</span><br><span class=line><span class="meta prompt_"># </span><span class=language-bash>Step 3: 写入软件源信息</span></span><br><span class=line>sudo add-apt-repository &quot;deb [arch=amd64] https://mirrors.aliyun.com/docker-ce/linux/ubuntu $(lsb_release -cs) stable&quot;</span><br><span class=line><span class="meta prompt_"># </span><span class=language-bash>Step 4: 更新并安装Docker-CE</span></span><br><span class=line>sudo apt-get -y update</span><br><span class=line>sudo apt-get -y install docker-ce</span><br></pre></td></tr></table></figure><h3 id=通过脚本安装><a href=#通过脚本安装 class=headerlink title=通过脚本安装></a>通过脚本安装</h3><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre></td><td class=code><pre><span class=line><span class="meta prompt_">$ </span><span class=language-bash>curl -fsSL https://get.docker.com -o get-docker.sh</span></span><br><span class=line><span class="meta prompt_">$ </span><span class=language-bash>sudo sh get-docker.sh --mirror Aliyun</span></span><br></pre></td></tr></table></figure><p>安装成功后，会自动启动 Docker 服务。用户可以使用 <code>systemctl is-enabled docker</code> 来确认 Docker 服务是否是开机自启动。</p><h3 id=可选配置><a href=#可选配置 class=headerlink title=可选配置></a>可选配置</h3><p><strong>解决 <code>WARNING: Your kernel does not support cgroup swap limit capabilities</code>：</strong></p><ol><li><p>编辑 <code>/etc/default/grub</code> 文件</p><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line><span class="meta prompt_">$ </span><span class=language-bash>nano /etc/default/grub</span></span><br></pre></td></tr></table></figure></li><li><p>找到 <code>GRUB_CMDLINE_LINUX=</code> 配置项，并追加 <code>cgroup_enable=memory swapaccount=1</code>。</p></li><li><p>保存文件后执行一下命令：<code>sudo update-grub</code></p></li><li><p>重启服务器：<code>reboot</code></p></li></ol><h3 id=测试-Docker-是否安装正确><a href=#测试-Docker-是否安装正确 class=headerlink title="测试 Docker 是否安装正确"></a>测试 Docker 是否安装正确</h3><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line><span class="meta prompt_">$ </span><span class=language-bash>docker run hello-world</span></span><br></pre></td></tr></table></figure><p>执行以上命令，若能正常输出以下信息，则说明安装成功。</p><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br></pre></td><td class=code><pre><span class=line>Unable to find image &#x27;hello-world:latest&#x27; locally</span><br><span class=line>latest: Pulling from library/hello-world</span><br><span class=line>1b930d010525: Pull complete</span><br><span class=line>Digest: sha256:f9dfddf63636d84ef479d645ab5885156ae030f611a56f3a7ac7f2fdd86d7e4e</span><br><span class=line>Status: Downloaded newer image for hello-world:latest</span><br><span class=line></span><br><span class=line>Hello from Docker!</span><br><span class=line>This message shows that your installation appears to be working correctly.</span><br><span class=line></span><br><span class=line>To generate this message, Docker took the following steps:</span><br><span class=line> 1. The Docker client contacted the Docker daemon.</span><br><span class=line> 2. The Docker daemon pulled the &quot;hello-world&quot; image from the Docker Hub.</span><br><span class=line>    (amd64)</span><br><span class=line> 3. The Docker daemon created a new container from that image which runs the</span><br><span class=line>    executable that produces the output you are currently reading.</span><br><span class=line> 4. The Docker daemon streamed that output to the Docker client, which sent it</span><br><span class=line>    to your terminal.</span><br><span class=line></span><br><span class=line>To try something more ambitious, you can run an Ubuntu container with:</span><br><span class=line> $ docker run -it ubuntu bash</span><br><span class=line></span><br><span class=line>Share images, automate workflows, and more with a free Docker ID:</span><br><span class=line> https://hub.docker.com/</span><br><span class=line></span><br><span class=line>For more examples and ideas, visit:</span><br><span class=line> https://docs.docker.com/get-started/</span><br></pre></td></tr></table></figure><h3 id=Docker-Deamon-配置><a href=#Docker-Deamon-配置 class=headerlink title="Docker Deamon 配置"></a>Docker Deamon 配置</h3><p>执行 <code>nano /etc/docker/daemon.json</code> 中写入如下内容：</p><figure class="highlight json"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br></pre></td><td class=code><pre><span class=line><span class=punctuation>&#123;</span></span><br><span class=line>  <span class=attr>&quot;ip&quot;</span><span class=punctuation>:</span> <span class=string>&quot;127.0.0.1&quot;</span><span class=punctuation>,</span></span><br><span class=line>  <span class=attr>&quot;experimental&quot;</span><span class=punctuation>:</span> <span class=literal><span class=keyword>false</span></span><span class=punctuation>,</span></span><br><span class=line>  <span class=attr>&quot;registry-mirrors&quot;</span><span class=punctuation>:</span> <span class=punctuation>[</span></span><br><span class=line>    <span class=string>&quot;https://registry.docker-cn.com&quot;</span><span class=punctuation>,</span></span><br><span class=line>    <span class=string>&quot;https://mirror.ccs.tencentyun.com&quot;</span><span class=punctuation>,</span></span><br><span class=line>    <span class=string>&quot;http://docker.mirrors.ustc.edu.cn&quot;</span><span class=punctuation>,</span></span><br><span class=line>    <span class=string>&quot;http://hub-mirror.c.163.com&quot;</span></span><br><span class=line>  <span class=punctuation>]</span></span><br><span class=line><span class=punctuation>&#125;</span></span><br></pre></td></tr></table></figure><p>重新启动服务:</p><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre></td><td class=code><pre><span class=line><span class="meta prompt_">$ </span><span class=language-bash>systemctl daemon-reload</span></span><br><span class=line><span class="meta prompt_">$ </span><span class=language-bash>systemctl restart docker.service</span></span><br></pre></td></tr></table></figure><h2 id=使用Docker镜像><a href=#使用Docker镜像 class=headerlink title=使用Docker镜像></a>使用Docker镜像</h2><h3 id=获取镜像><a href=#获取镜像 class=headerlink title=获取镜像></a>获取镜像</h3><blockquote><p><code>docker pull [选项] [Docker Registry 地址[:端口号]/][用户名]&lt;仓库名&gt;[:TAG]</code></p></blockquote><ul><li>默认选项<ul><li><code>-a</code>，<code>--all-tags=true|false</code>：是否获取仓库中的所有镜像，默认为否</li><li><code>--disable-content-trust</code>：取消镜像的内容校验，默认为真</li></ul></li><li>默认 Docker Registry：<code>registry.hub.docker.com</code></li><li>默认用户名：<code>library</code>，也就是官方镜像</li><li>默认TAG：<code>latest</code></li></ul><h3 id=查看镜像信息><a href=#查看镜像信息 class=headerlink title=查看镜像信息></a>查看镜像信息</h3><h4 id=列出本地主机上已有镜像><a href=#列出本地主机上已有镜像 class=headerlink title=列出本地主机上已有镜像></a>列出本地主机上已有镜像</h4><blockquote><p><code>docker image ls</code> | <code>docker images</code></p></blockquote><p>镜像的大小信息只是表示了该镜像的逻辑体积大小，实际上由于相同的镜像层本地只会存储一份，物理上占用的存储空间会小于各镜像逻辑体积之和。</p><h4 id=使用-tag-命令添加镜像标签><a href=#使用-tag-命令添加镜像标签 class=headerlink title="使用 tag 命令添加镜像标签"></a>使用 tag 命令添加镜像标签</h4><blockquote><p><code>docker tag ubuntu:latest myubuntu:latest</code></p></blockquote><p>为了方便在后续工作中使用特定镜像，还可以使用 <code>docker tag</code> 命令来为本地镜像任意添加新的标签。</p><h4 id=使用-inspect-命令查看详细信息><a href=#使用-inspect-命令查看详细信息 class=headerlink title="使用 inspect 命令查看详细信息"></a>使用 inspect 命令查看详细信息</h4><blockquote><p><code>docker inspect &lt;仓库&gt;</code></p></blockquote><p>使用 <code>docker inspect</code> 命令可以获取该镜像的详细信息，包括制作者、适应架构、各层的数字摘要等。</p><h4 id=使用-history-命令查看镜像历史><a href=#使用-history-命令查看镜像历史 class=headerlink title="使用 history 命令查看镜像历史"></a>使用 history 命令查看镜像历史</h4><blockquote><p><code>docker history &lt;REPOSITORY&gt;[:TAG]</code> 或 <code>docker history &lt;IMAGE ID&gt;</code></p></blockquote><p>注意，过长的命令会被自动截断了，可以使用 <code>--no-trunc</code> 选项来输出完整命令。</p><h4 id=删除镜像><a href=#删除镜像 class=headerlink title=删除镜像></a>删除镜像</h4><ol><li><p>使用标签删除镜像</p><blockquote><p><code>docker rmi &lt;IMAGE&gt; [IMAGE...]</code> 或 <code>docker image rm &lt;IMAGE&gt; [IMAGE...]</code></p></blockquote></li><li><p>使用镜像 ID 来删除镜像</p><blockquote><p><code>docker rmi &lt;IMAGE ID&gt;</code></p></blockquote><p>当使用 <code>docker rmi</code> 命令，并且后面跟上镜像的 ID（也可以是能进行区分的部分 ID 串前缀）时，会先尝试删除所有指向该镜像的标签，然后删除该镜像文件本身。</p><blockquote><p>注意，当有基于该镜像创建的容器时，镜像文件默认是无法被删除的。我们可以使用 <code>docker ps -a</code> 命令可以查看本机上存在的所有容器。</p><p>最佳实践：先用 <code>docker rm &lt;Container ID&gt;</code> 删除依赖该镜像的所有容易，然后执行 <code>docker rmi &lt;IMAGE ID&gt;</code> 再来删除镜像。</p></blockquote></li></ol><h4 id=清理镜像><a href=#清理镜像 class=headerlink title=清理镜像></a>清理镜像</h4><blockquote><p><code>docker image prune [options]</code></p><ul><li><code>-a</code>，<code>--all</code>：删除所有无用镜像，不光是临时镜像</li><li><code>-f</code>,<code>--force</code>：强制删除镜像，而不进行提示确认</li></ul></blockquote><p>使用 Docker 一段时间后，系统中可能会遗留一些临时的镜像文件，以及没有使用的镜像，可以通过 <code>docker image prune</code> 命令来进行清理。</p><p>我们可以结合 crontab 来定时清理，执行 <code>crontab -e</code>，写入一下配置：</p><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre></td><td class=code><pre><span class=line># 一定要记得在后面按 Enter 输入换行符，否则不会生效的</span><br><span class=line>59 23 * * * docker image prune -f</span><br><span class=line></span><br></pre></td></tr></table></figure><h3 id=创建镜像><a href=#创建镜像 class=headerlink title=创建镜像></a>创建镜像</h3><h4 id=1-基于已有容器创建><a href=#1-基于已有容器创建 class=headerlink title="1. 基于已有容器创建"></a>1. 基于已有容器创建</h4><blockquote><p><code>docker commit [OPTIONS] &lt;CONTAINER&gt; &lt;REPOSITORY&gt;[:TAG]</code></p><ul><li><code>-a</code>，<code>--author=</code>：作者信息</li><li><code>-m</code>，<code>--message=&quot;&quot;</code>：提交信息</li><li><code>-p</code>，<code>--pause=true</code>：提交时暂停容器执行</li></ul></blockquote><p>首先，启动一个 alpine 镜像，并在其中进行安装 nano 的操作，然后发布一个新的镜像：</p><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre></td><td class=code><pre><span class=line><span class="meta prompt_">$ </span><span class=language-bash>docker run -it alpine bash</span></span><br><span class=line><span class="meta prompt_">$ </span><span class=language-bash>docker commit -m <span class=string>&quot;install nano&quot;</span> -a <span class=string>&quot;杨俊宁&quot;</span> ff3034d2ffa7 my-alpine:0.1</span></span><br></pre></td></tr></table></figure><h4 id=2-基于-Dockerfile-创建><a href=#2-基于-Dockerfile-创建 class=headerlink title="2. 基于 Dockerfile 创建"></a>2. 基于 Dockerfile 创建</h4><blockquote><p><code>docker build -t &lt;IMAGE NAME&gt; &lt;上下文路径/URL/-&gt;</code></p></blockquote><p>通过 Dockerfile 创建是最常见的方式。Dockerfile 是一个文本文件，利用指定的指令描述基于某个父镜像创建新镜像的过程。</p><p>下面给出 Dockerfile 的一个简单示例，基于 alpine 镜像安装 node 环境，构成一个新的 <code>youngjuning/alpine</code> 镜像：</p><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre></td><td class=code><pre><span class=line>FROM alpine</span><br><span class=line></span><br><span class=line>LABEL version=&quot;1.0&quot; maintainer=&quot;youngjuning&lt;youngjuning@aliyun.com&gt;&quot;</span><br><span class=line></span><br><span class=line>RUN sed -i &#x27;s/dl-cdn.alpinelinux.org/mirrors.aliyun.com/g&#x27; /etc/apk/repositories</span><br></pre></td></tr></table></figure><p>构建：</p><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line><span class="meta prompt_">$ </span><span class=language-bash>docker build -t youngjuning/alpine:latest .</span></span><br></pre></td></tr></table></figure><h3 id=存储镜像><a href=#存储镜像 class=headerlink title=存储镜像></a>存储镜像</h3><p>如果要导出镜像到本地文件，可以使用 <code>docker save</code> 命令。该命令支持 <code>-o &lt;string&gt;</code> 或 <code>--output &lt;string&gt;</code> 参数，导出镜像到指定的文件中。</p><p>例如，导出本地 alpine 镜像为文件 alpine.tar，如下所示：</p><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line><span class="meta prompt_">$ </span><span class=language-bash>docker save -o alpine.tar alpine</span></span><br></pre></td></tr></table></figure><p>之后，用户就可以通过复制 alpine.tar 文件将该镜像分享给他人。</p><h3 id=载入镜像><a href=#载入镜像 class=headerlink title=载入镜像></a>载入镜像</h3><p>可以使用 <code>docker load</code> 将导出的 tar 文件再导入到本地镜像库。支持 <code>-i &lt;string&gt;</code> 或 <code>-input &lt;string&gt;</code> 选项，从指定文件中读入镜像内容。</p><p>例如，从文件 alpine.tar 导入镜像到本地镜像列表，如下所示：</p><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line><span class="meta prompt_">$ </span><span class=language-bash>docker load -i alpine.tar</span></span><br></pre></td></tr></table></figure><h3 id=上传镜像><a href=#上传镜像 class=headerlink title=上传镜像></a>上传镜像</h3><blockquote><p><code>docker push [选项] [Docker Registry 地址[:端口号]/][用户名]&lt;仓库名&gt;[:TAG]</code></p></blockquote><p><strong>发布新版本流程：</strong></p><ul><li>发布 latest 版本：<code>docker push youngjuning/alpine:latest</code></li><li>添加新标签：<code>docker tag youngjuning/alpine:latest youngjuning/alpine:1.0.0</code></li><li>发布 1.0.0 版本：<code>docker push youngjuning/alpine:1.0.0</code></li></ul><blockquote><p>可以查看<a target=_blank rel="noopener external nofollow noreferrer" href=https://hub.docker.com/r/youngjuning/alpine%E9%A1%B9%E7%9B%AE%E6%9F%A5%E7%9C%8B%E6%88%91%E5%8F%91%E5%B8%83%E7%9A%84%E5%9F%BA%E4%BA%8Ealiyun%E9%95%9C%E5%83%8F%E7%9A%84>https://hub.docker.com/r/youngjuning/alpine项目查看我发布的基于aliyun镜像的</a> Aplpine Docker Image</p></blockquote><h2 id=操作-Docker-容器><a href=#操作-Docker-容器 class=headerlink title="操作 Docker 容器"></a>操作 Docker 容器</h2><ul><li>Docker 容器是镜像的一个运行实例。</li><li>Docker 容器是独立运行的一个（或一组）应用，以及它们必需的运行环境</li></ul><h3 id=启动容器><a href=#启动容器 class=headerlink title=启动容器></a>启动容器</h3><h4 id=1-新建并启动><a href=#1-新建并启动 class=headerlink title="1. 新建并启动"></a>1. 新建并启动</h4><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line><span class="meta prompt_">$ </span><span class=language-bash>docker run -it ubuntu:18.04 /bin/bash</span></span><br></pre></td></tr></table></figure><p>其中, <code>-t</code> 选项让 Docker 分配一个伪终端（pseudo-tty）并绑定到容器的标准输入上，<code>-i</code> 则让容器的标准输入保持打开。</p><p>当利用 <code>docker run</code> 来创建容器时，Docker 在后台运行的标准操作包括：</p><ol><li>检查本地是否存在指定的镜像，不存在就从公有仓库下载</li><li>利用镜像创建并启动一个容器</li><li>分配一个文件系统，并在只读的镜像层外面挂在一层可读写层</li><li>从宿主主机配置的网桥接口中桥接一个虚拟接口到容器中去</li><li>从地址池配置一个ip地址给容器</li><li>执行用户指定的应用程序</li><li>执行完毕后容器被终止</li></ol><p><strong>一些常用选项：</strong></p><ul><li><code>-d</code>，<code>--detach=true|false</code>：是否在后台运行容器，默认为<code>false</code></li><li><code>-i</code>，<code>--interactive=true|false</code>：保持标准输入打开，默认为 <code>false</code></li><li><code>-p</code>，<code>--publish=[]</code>：指定如何映射到本地主机端口，例如 <code>-p 9000:9000</code></li><li><code>--restart=&quot;no&quot;</code>：容器的重启策略，包括 <code>no</code>、<code>on-failure[:max-retry]</code>、<code>always</code>、<code>unless-stopped</code> 等</li><li><code>--rm=true|false</code>：容器退出后是否自动删除，不能跟 <code>-d</code> 同时使用</li><li><code>-t</code>，<code>--tty=true|false</code>：是否分配一个伪终端，默认为 <code>false</code></li><li><code>-v [HOST-DIR:]&lt;CONTAINER-DIR&gt;[:OPTIONS]</code>，<code>--volume=[HOST-DIR:]&lt;CONTAINER-DIR&gt;[:OPTIONS]</code>：挂在主机上的文件卷到容器内</li><li><code>--name=&quot;&quot;</code>：指定容器的别名</li></ul><h4 id=2-启动已终止容器><a href=#2-启动已终止容器 class=headerlink title="2. 启动已终止容器"></a>2. 启动已终止容器</h4><p>可以利用 <code>docker start &lt;CONTAINER ID&gt;</code> 命令，直接将一个已经终止的容器启动运行。</p><h4 id=3-查看容器输出><a href=#3-查看容器输出 class=headerlink title="3. 查看容器输出"></a>3. 查看容器输出</h4><p>要获取容器的输出信息，可以通过 <code>docker &lt;CONTAINER ID&gt; logs</code> 命令。</p><h3 id=终止容器><a href=#终止容器 class=headerlink title=终止容器></a>终止容器</h3><p>可以使用 <code>docker stop &lt;CONTAINER ID&gt;</code> 来终止一个运行中的容器。</p><p>处于终止状态的容器，可以通过 <code>docker container start</code> 命令来重新启动。</p><p>此外，<code>docker container restart</code> 命令会将一个运行态的容器终止，然后再重新启动它。</p><h3 id=exec进入容器><a href=#exec进入容器 class=headerlink title=exec进入容器></a><code>exec</code>进入容器</h3><p>在使用 <code>-d</code> 参数时，容器启动后会进入后台。</p><p>某些时候需要进入容器进行操作，推荐大家使用 <code>docker exec</code> 命令：</p><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre></td><td class=code><pre><span class=line><span class="meta prompt_">$ </span><span class=language-bash>docker run -dit alpine</span></span><br><span class=line><span class="meta prompt_">$ </span><span class=language-bash>docker ps</span></span><br><span class=line>CONTAINER ID        IMAGE                 COMMAND             CREATED             STATUS              PORTS                      NAMES</span><br><span class=line>3d95dabef801        alpine                &quot;/bin/sh&quot;           21 seconds ago      Up 19 seconds                                  recursing_aryabhata</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line><span class="meta prompt_">$ </span><span class=language-bash>docker <span class=built_in>exec</span> -it &lt;CONTAINER ID&gt;</span></span><br></pre></td></tr></table></figure><p>如果从这个 stdin 中 exit，不会导致容器的停止。</p><h3 id=删除容器><a href=#删除容器 class=headerlink title=删除容器></a>删除容器</h3><p>可以使用 <code>docker container rm</code> 来删除一个处于终止状态的容器。例如</p><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre></td><td class=code><pre><span class=line><span class="meta prompt_">$ </span><span class=language-bash>docker <span class=built_in>rm</span>  &lt;CONTAINER ID&gt;</span></span><br><span class=line><span class="meta prompt_"># </span><span class=language-bash>删除运行中的容器，并删除容器挂载的数据卷</span></span><br><span class=line><span class="meta prompt_">$ </span><span class=language-bash>docker <span class=built_in>rm</span> -vf</span></span><br></pre></td></tr></table></figure><p>如果要删除一个运行中的容器，可以添加 <code>-f</code> 参数。Docker 会发送 <code>SIGKILL</code> 信号给容器。</p><h3 id=清理所有处于终止状态的容器><a href=#清理所有处于终止状态的容器 class=headerlink title=清理所有处于终止状态的容器></a>清理所有处于终止状态的容器</h3><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line><span class="meta prompt_">$ </span><span class=language-bash>docker container prune</span></span><br></pre></td></tr></table></figure><h3 id=导出和导入容器><a href=#导出和导入容器 class=headerlink title=导出和导入容器></a>导出和导入容器</h3><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre></td><td class=code><pre><span class=line><span class="meta prompt_">$ </span><span class=language-bash>docker <span class=built_in>export</span> 7691a814370e &gt; ubuntu.tar</span></span><br><span class=line><span class="meta prompt_">$ </span><span class=language-bash><span class=built_in>cat</span> ubuntu.tar | docker import - <span class=built_in>test</span>/ubuntu:v1.0</span></span><br><span class=line><span class="meta prompt_">$ </span><span class=language-bash>docker import http://example.com/exampleimage.tgz example/imagerepo</span></span><br></pre></td></tr></table></figure><h3 id=查看容器><a href=#查看容器 class=headerlink title=查看容器></a>查看容器</h3><h4 id=1-查看容器详情><a href=#1-查看容器详情 class=headerlink title="1. 查看容器详情"></a>1. 查看容器详情</h4><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line><span class="meta prompt_">$ </span><span class=language-bash>docker inspect [OPTIONS] &lt;CONTAINER ID&gt;</span></span><br></pre></td></tr></table></figure><h4 id=2-查看容器内进程><a href=#2-查看容器内进程 class=headerlink title="2. 查看容器内进程"></a>2. 查看容器内进程</h4><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line><span class="meta prompt_">$ </span><span class=language-bash>docker top [OPTIONS] &lt;CONTAINER ID&gt;</span></span><br></pre></td></tr></table></figure><h4 id=3-查看统计信息><a href=#3-查看统计信息 class=headerlink title="3. 查看统计信息"></a>3. 查看统计信息</h4><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line><span class="meta prompt_">$ </span><span class=language-bash>docker stats [OPTIONS] &lt;CONTAINER ID&gt;</span></span><br></pre></td></tr></table></figure><h3 id=更新配置><a href=#更新配置 class=headerlink title=更新配置></a>更新配置</h3><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line><span class="meta prompt_">$ </span><span class=language-bash>docker update --restart=always &lt;CONTAINER ID&gt;</span></span><br></pre></td></tr></table></figure><h3 id=重命名容器><a href=#重命名容器 class=headerlink title=重命名容器></a>重命名容器</h3><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line><span class="meta prompt_">$ </span><span class=language-bash>docker rename &lt;old name&gt; &lt;new name&gt;</span></span><br></pre></td></tr></table></figure><h3 id=查看容器日志><a href=#查看容器日志 class=headerlink title=查看容器日志></a>查看容器日志</h3><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line><span class="meta prompt_">$ </span><span class=language-bash>docker logs -f &lt;CONTAINER ID&gt;</span></span><br></pre></td></tr></table></figure><h3 id=Portainer-容器管理工具><a href=#Portainer-容器管理工具 class=headerlink title="Portainer 容器管理工具"></a>Portainer 容器管理工具</h3><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br></pre></td><td class=code><pre><span class=line><span class="meta prompt_">$ </span><span class=language-bash>docker volume create portainer_data</span></span><br><span class=line><span class="meta prompt_">$ </span><span class=language-bash>docker run -d -p 9000:9000 \</span></span><br><span class=line><span class=language-bash>		-v /var/run/docker.sock:/var/run/docker.sock \</span></span><br><span class=line><span class=language-bash>		-v portainer_data:/data \</span></span><br><span class=line><span class=language-bash>		--name portainer \</span></span><br><span class=line><span class=language-bash>		--restart always \</span></span><br><span class=line><span class=language-bash>		portainer/portainer</span></span><br></pre></td></tr></table></figure><p>配置 <code>/etc/nginx/sites-enabled/dafulat</code> 文件：</p><figure class="highlight nginx"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br></pre></td><td class=code><pre><span class=line><span class=section>upstream</span> portainer &#123;</span><br><span class=line>    <span class=attribute>server</span> <span class=number>127.0.0.1:9000</span>;</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line><span class=section>server</span> &#123;</span><br><span class=line>  <span class=attribute>listen</span> <span class=number>80</span>;</span><br><span class=line></span><br><span class=line>  <span class=section>location</span> /portainer/ &#123;</span><br><span class=line>      <span class=attribute>proxy_http_version</span> <span class=number>1</span>.<span class=number>1</span>;</span><br><span class=line>      <span class=attribute>proxy_set_header</span> Connection <span class=string>&quot;&quot;</span>;</span><br><span class=line>      <span class=attribute>proxy_pass</span> http://portainer/;</span><br><span class=line>  &#125;</span><br><span class=line>  <span class=section>location</span> /portainer/ws/ &#123;</span><br><span class=line>      <span class=attribute>proxy_set_header</span> Upgrade <span class=variable>$http_upgrade</span>;</span><br><span class=line>      <span class=attribute>proxy_set_header</span> Connection <span class=string>&quot;upgrade&quot;</span>;</span><br><span class=line>      <span class=attribute>proxy_http_version</span> <span class=number>1</span>.<span class=number>1</span>;</span><br><span class=line>      <span class=attribute>proxy_pass</span> http://portainer/ws/;</span><br><span class=line>  &#125;</span><br><span class=line>&#125;</span><br></pre></td></tr></table></figure><h2 id=Docker-数据持久化><a href=#Docker-数据持久化 class=headerlink title="Docker 数据持久化"></a>Docker 数据持久化</h2><p><code>数据卷</code> 是一个可供一个或多个容器使用的特殊目录，它绕过 UFS，可以提供很多有用的特性：</p><ul><li><code>数据卷</code> 可以在容器之间共享和重用</li><li>对 <code>数据卷</code> 的修改会立马生效</li><li>对 <code>数据卷</code> 的更新，不会影响镜像</li><li><code>数据卷</code> 默认会一直存在，即使容器被删除</li></ul><h3 id=1-创建数据卷><a href=#1-创建数据卷 class=headerlink title="1. 创建数据卷"></a>1. 创建数据卷</h3><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line><span class="meta prompt_">$ </span><span class=language-bash>docker volume create my-vol</span></span><br></pre></td></tr></table></figure><p>除了 <code>create</code> 子命令外，docker volume 还支持 <code>inspect</code>(查看详细信息)、<code>ls</code>（列出已有数据卷）、<code>prune</code>（清理无用数据卷）、<code>rm</code>（删除数据卷）</p><h3 id=2-绑定数据卷><a href=#2-绑定数据卷 class=headerlink title="2. 绑定数据卷"></a>2. 绑定数据卷</h3><h4 id=mount><a href=#mount class=headerlink title=--mount></a><code>--mount</code></h4><figure class="highlight bash"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre></td><td class=code><pre><span class=line>$ docker run -d -P \</span><br><span class=line>    --name web \</span><br><span class=line>    --mount <span class=built_in>source</span>=my-vol,target=/webapp \</span><br><span class=line>    training/webapp \</span><br><span class=line>    python app.py</span><br></pre></td></tr></table></figure><h4 id=v，-volume><a href=#v，-volume class=headerlink title=-v，--volume></a><code>-v</code>，<code>--volume</code></h4><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre></td><td class=code><pre><span class=line><span class="meta prompt_">$ </span><span class=language-bash>docker run -d -P \</span></span><br><span class=line><span class=language-bash>    --name web \</span></span><br><span class=line><span class=language-bash>    -v my-vol:/wepapp \</span></span><br><span class=line><span class=language-bash>    training/webapp \</span></span><br><span class=line><span class=language-bash>    python app.py</span></span><br></pre></td></tr></table></figure><blockquote><p>source 也可以是绝对路径的任意系统位置。</p></blockquote><blockquote><p>如果直接挂载一个文件到容器，使用文件编辑工具，包括 vi 或者 <code>sed --in-place</code> 的时候，可能会造成文件 inode 的改变，从 Docker 1.1 起，这会导致报错误信息。所以推荐的方式是直接挂载文件所在的目录到容器内。</p></blockquote><h2 id=Dockerfile><a href=#Dockerfile class=headerlink title=Dockerfile></a>Dockerfile</h2><blockquote><p>详细指令详解请查看：<a target=_blank rel="noopener external nofollow noreferrer" href=https://vuepress.mirror.docker-practice.com/image/dockerfile/ >Dockerfile 指令详解</a></p></blockquote><p><img src=https://i.loli.net/2020/04/11/hmlMV4QA2opON9j.png></p><h1 id=应用安装><a href=#应用安装 class=headerlink title=应用安装></a>应用安装</h1><h2 id=GitLab-及其官方镜像><a href=#GitLab-及其官方镜像 class=headerlink title="GitLab 及其官方镜像"></a>GitLab 及其官方镜像</h2><blockquote><p>特别耗CPU，我的服务器太辣鸡带不动！！！</p></blockquote><h3 id=docker-compose-yml><a href=#docker-compose-yml class=headerlink title=docker-compose.yml></a>docker-compose.yml</h3><figure class="highlight yaml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br></pre></td><td class=code><pre><span class=line><span class=attr>web:</span></span><br><span class=line>  <span class=attr>image:</span> <span class=string>&#x27;gitlab/gitlab-ce:latest&#x27;</span></span><br><span class=line>  <span class=attr>restart:</span> <span class=string>always</span></span><br><span class=line>  <span class=attr>hostname:</span> <span class=string>&#x27;gitlab.yangjunning.pro&#x27;</span></span><br><span class=line>  <span class=attr>environment:</span></span><br><span class=line>    <span class=attr>GITLAB_OMNIBUS_CONFIG:</span> <span class=string>|</span></span><br><span class=line><span class=string>      external_url &#x27;http://gitlab.yangjunning.pro:8929&#x27;</span></span><br><span class=line><span class=string>      gitlab_rails[&#x27;gitlab_shell_ssh_port&#x27;] = 2224</span></span><br><span class=line><span class=string></span>  <span class=attr>ports:</span></span><br><span class=line>    <span class=bullet>-</span> <span class=string>&#x27;8929:8929&#x27;</span></span><br><span class=line>    <span class=bullet>-</span> <span class=string>&#x27;2224:22&#x27;</span></span><br><span class=line>  <span class=attr>volumes:</span></span><br><span class=line>    <span class=bullet>-</span> <span class=string>&#x27;gitlab_config:/etc/gitlab&#x27;</span></span><br><span class=line>    <span class=bullet>-</span> <span class=string>&#x27;gitlab_logs:/var/log/gitlab&#x27;</span></span><br><span class=line>    <span class=bullet>-</span> <span class=string>&#x27;gitlab_data:/var/opt/gitlab&#x27;</span></span><br></pre></td></tr></table></figure><h3 id=运行容器><a href=#运行容器 class=headerlink title=运行容器></a>运行容器</h3><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>$ docker-compose up -d</span><br></pre></td></tr></table></figure><h3 id=更新-gitlab><a href=#更新-gitlab class=headerlink title="更新 gitlab"></a>更新 gitlab</h3><figure class="highlight shell"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre></td><td class=code><pre><span class=line><span class="meta prompt_">$ </span><span class=language-bash>docker-compose pull</span></span><br><span class=line><span class="meta prompt_">$ </span><span class=language-bash>docker-compose up -d</span></span><br></pre></td></tr></table></figure><h2 id=待实践><a href=#待实践 class=headerlink title=待实践></a>待实践</h2><ul><li>SonarQube</li><li>Nexus Repository Manager</li><li>ShowDoc</li><li>Verdaccio</li><li>EasyMock</li><li>Sentry</li><li>Ansible</li><li>code-push-server</li><li>BugOut</li></ul><h1 id=Docker-相关的定时任务><a href=#Docker-相关的定时任务 class=headerlink title="Docker 相关的定时任务"></a>Docker 相关的定时任务</h1><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre></td><td class=code><pre><span class=line># crontab -e</span><br><span class=line># 每天凌晨强制删除无用镜像，不光是临时镜像；每天凌晨清理无用的数据卷</span><br><span class=line>00 00 * * * docker image prune -af &amp;&amp; docker volume prune -f &amp;&amp; rsync -arv /var/lib/docker/volumes /backups/docker</span><br></pre></td></tr></table></figure><blockquote><p>qshell 同步文件到七牛云的配置请参考<a target=_blank rel="noopener external nofollow noreferrer" href=https://juejin.im/post/5e81e2db518825737b4ad911#heading-59>备份到七牛云</a></p></blockquote><h1 id=扩展阅读><a href=#扩展阅读 class=headerlink title=扩展阅读></a>扩展阅读</h1><ul><li><a target=_blank rel="noopener external nofollow noreferrer" href=https://devops.phodal.com/ >DevOps 知识平台 Ledge</a></li><li><a target=_blank rel="noopener external nofollow noreferrer" href=https://juejin.im/post/5b6af759e51d451951138eb4#heading-7>jenkins+docker 持续集成</a></li></ul></article><div class=post-copyright><div class=post-copyright__author><span class=post-copyright-meta>文章作者: </span><span class=post-copyright-info><a target=_blank rel="noopener external nofollow noreferrer" href=https://github.com/youngjuning>洛竹</a></span></div><div class=post-copyright__type><span class=post-copyright-meta>文章链接: </span><span class=post-copyright-info><a href=https://youngjuning.js.org/8e0831eec81f/ >https://youngjuning.js.org/8e0831eec81f/</a></span></div><div class=post-copyright__notice><span class=post-copyright-meta>版权声明: </span><span class=post-copyright-info>本博客所有文章除特别声明外，均采用 <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ rel="external nofollow noreferrer" target=_blank>CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href=https://youngjuning.js.org target=_blank>洛竹的博客</a>！</span></div></div><div class=tag_share><div class=post-meta__tag-list><a class=post-meta__tags href=/tags/%E7%AC%94%E8%AE%B0/ >笔记</a><a class=post-meta__tags href=/tags/Docker/ >Docker</a></div><div class=post_share><div class=social-share data-image=https://i.loli.net/2020/03/31/UI9JSTCENRvqDwY.png data-sites=facebook,twitter,wechat,weibo,qq></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css media=print onload='this.media="all"'><script src=https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js defer=defer></script></div></div><div class=post-reward><div class=reward-button><i class="fas fa-qrcode"></i> 打赏</div><div class=reward-main><ul class=reward-all><li class=reward-item><a href=https://cdn.jsdelivr.net/gh/youngjuning/images/wechat.png rel="external nofollow noreferrer" target=_blank><img class=post-qr-code-img src=https://cdn.jsdelivr.net/gh/youngjuning/images/wechat.png alt=微信></a><div class=post-qr-code-desc>微信</div></li><li class=reward-item><a href=https://cdn.jsdelivr.net/gh/youngjuning/images/alipay7.png rel="external nofollow noreferrer" target=_blank><img class=post-qr-code-img src=https://cdn.jsdelivr.net/gh/youngjuning/images/alipay7.png alt=支付宝></a><div class=post-qr-code-desc>支付宝</div></li></ul></div></div><div class=ads-wrap><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-7962287588031867 data-ad-slot=2542544532></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><nav class=pagination-post id=pagination><div class="prev-post pull-left"><a href=/cc88fa106758/ title="Typora 基于 PicGo-Core 实现粘贴上传图片"><img class=cover src=https://cdn.pixabay.com/photo/2023/01/30/19/40/gulls-7756481_1280.jpg onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class=pagination-info><div class=label>上一篇</div><div class=prev_info>Typora 基于 PicGo-Core 实现粘贴上传图片</div></div></a></div><div class="next-post pull-right"><a href=/ef588191ce47/ title=写给前端的Linux实战教程><img class=cover src=https://i.loli.net/2020/03/30/rzVCW97GcjAa81k.png onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class=pagination-info><div class=label>下一篇</div><div class=next_info>写给前端的Linux实战教程</div></div></a></div></nav><div class=relatedPosts><div class=headline><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class=relatedPosts-list><div><a href=/689ef57f4320/ title=《JavaScript高级程序设计》阅读笔记><img class=cover src=https://i.loli.net/2020/02/06/nKlMCA4agtzHc6R.png alt=cover><div class="content is-center"><div class=date><i class="far fa-calendar-alt fa-fw"></i> 2020-02-06</div><div class=title>《JavaScript高级程序设计》阅读笔记</div></div></a></div></div></div><hr><div id=post-comment><div class=comment-head><div class=comment-headline><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id=comment-switch><span class=first-comment>Giscus</span><span class=switch-btn></span><span class=second-comment>Livere</span></div></div><div class=comment-wrap><div><div id=giscus-wrap></div></div><div><div id=lv-container data-id=city data-uid="MTAyMC81NDMyMi8zMDc5Mw=="></div></div></div></div></div><div class=aside-content id=aside-content><div class="card-widget card-info"><div class=is-center><div class=avatar-img><img src=https://picbed.qunarzz.com/af8c84d2c24a6b971153e6620f3218ad.png onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt=avatar></div><div class=author-info__name>洛竹</div><div class=author-info__description>真理无穷，一寸欢喜。</div></div><div class="card-info-data site-data is-center"><a href=/archives/ ><div class=headline>文章</div><div class=length-num>111</div></a><a href=/tags/ ><div class=headline>标签</div><div class=length-num>238</div></a><a href=/categories/ ><div class=headline>分类</div><div class=length-num>36</div></a></div><a id=card-info-btn target=_blank rel="noopener external nofollow noreferrer" href=https://github.com/youngjuning><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class=social-icon href=https://github.com/youngjuning/youngjuning.github.io rel="external nofollow noreferrer" target=_blank title=Github><i class="fab fa-github"></i></a><a class=social-icon href=mailto:youngjuning@163.com rel="external nofollow noreferrer" target=_blank title=Email><i class="fas fa-envelope"></i></a><a class=social-icon href=https://cdn.jsdelivr.net/gh/youngjuning/images/202109211725265.png rel="external nofollow noreferrer" target=_blank title=微信><i class="fab fa-weixin"></i></a></div></div><div class="card-widget card-announcement"><div class=item-headline><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class=announcement_content><div><a target=_blank rel="noopener external nofollow noreferrer" href="https://addslice.com/?crew=wHXyN"><img src=https://cdn.jsdelivr.net/gh/youngjuning/images@main/1679935291274.jpg style=width:100%></a></div></div></div><div class="card-widget Gate.io" id=Gate.io><div class=item-headline><i class="fab fa-btc"></i><span>Gate.io 加密货币交易所</span></div><div class=item-content><a target=_blank rel="noopener external nofollow noreferrer" href=https://www.gate.io/ref/9923157><img src=https://cdn.jsdelivr.net/gh/youngjuning/images@main/1680151212227.jpg width=100% alt=Gate.io></a></div></div><div class="card-widget user-map" id=user-map><div class=item-headline><i class="fas fa-heartbeat"></i><span>访客地图</span></div><div class=item-content><script type=text/javascript id=clstr_globe src="//clustrmaps.com/globe.js?d=GxY0uNwJ-R6qfXXonTr3FEq7qT8qAPpGdd-XpGVHSEo"></script></div></div><div class=sticky_layout><div class=card-widget id=card-toc><div class=item-headline><i class="fas fa-stream"></i><span>目录</span><span class=toc-percentage></span></div><div class="toc-content is-expand"><ol class=toc><li class="toc-item toc-level-1"><a class=toc-link href=#%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8><span class=toc-number>1.</span> <span class=toc-text>基础入门</span></a><ol class=toc-child><li class="toc-item toc-level-2"><a class=toc-link href=#%E6%A6%82%E5%BF%B5><span class=toc-number>1.1.</span> <span class=toc-text>概念</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#DevOps><span class=toc-number>1.1.1.</span> <span class=toc-text>DevOps</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%AE%B9%E5%99%A8><span class=toc-number>1.1.2.</span> <span class=toc-text>容器</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E8%99%9A%E6%8B%9F%E5%8C%96><span class=toc-number>1.1.3.</span> <span class=toc-text>虚拟化</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#Docker-%E4%B8%8E%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%AF%94%E8%BE%83><span class=toc-number>1.1.4.</span> <span class=toc-text>Docker 与虚拟机比较</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#Docker%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5><span class=toc-number>1.1.5.</span> <span class=toc-text>Docker核心概念</span></a><ol class=toc-child><li class="toc-item toc-level-4"><a class=toc-link href=#%E9%95%9C%E5%83%8F%EF%BC%88Image%EF%BC%89><span class=toc-number>1.1.5.1.</span> <span class=toc-text>镜像（Image）</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#%E5%AE%B9%E5%99%A8%EF%BC%88Container%EF%BC%89><span class=toc-number>1.1.5.2.</span> <span class=toc-text>容器（Container）</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#%E4%BB%93%E5%BA%93%E6%B3%A8%E5%86%8C%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%88Registry%EF%BC%89><span class=toc-number>1.1.5.3.</span> <span class=toc-text>仓库注册服务器（Registry）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8B-daemon><span class=toc-number>1.1.6.</span> <span class=toc-text>守护进程 daemon</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE><span class=toc-number>1.2.</span> <span class=toc-text>安装配置</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%8D%B8%E8%BD%BD%E6%97%A7%E7%89%88%E6%9C%AC><span class=toc-number>1.2.1.</span> <span class=toc-text>卸载旧版本</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E9%80%9A%E8%BF%87%E8%BD%AF%E4%BB%B6%E5%8C%85%E5%AE%89%E8%A3%85><span class=toc-number>1.2.2.</span> <span class=toc-text>通过软件包安装</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E9%80%9A%E8%BF%87%E8%84%9A%E6%9C%AC%E5%AE%89%E8%A3%85><span class=toc-number>1.2.3.</span> <span class=toc-text>通过脚本安装</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%8F%AF%E9%80%89%E9%85%8D%E7%BD%AE><span class=toc-number>1.2.4.</span> <span class=toc-text>可选配置</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%B5%8B%E8%AF%95-Docker-%E6%98%AF%E5%90%A6%E5%AE%89%E8%A3%85%E6%AD%A3%E7%A1%AE><span class=toc-number>1.2.5.</span> <span class=toc-text>测试 Docker 是否安装正确</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#Docker-Deamon-%E9%85%8D%E7%BD%AE><span class=toc-number>1.2.6.</span> <span class=toc-text>Docker Deamon 配置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E4%BD%BF%E7%94%A8Docker%E9%95%9C%E5%83%8F><span class=toc-number>1.3.</span> <span class=toc-text>使用Docker镜像</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E8%8E%B7%E5%8F%96%E9%95%9C%E5%83%8F><span class=toc-number>1.3.1.</span> <span class=toc-text>获取镜像</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%9F%A5%E7%9C%8B%E9%95%9C%E5%83%8F%E4%BF%A1%E6%81%AF><span class=toc-number>1.3.2.</span> <span class=toc-text>查看镜像信息</span></a><ol class=toc-child><li class="toc-item toc-level-4"><a class=toc-link href=#%E5%88%97%E5%87%BA%E6%9C%AC%E5%9C%B0%E4%B8%BB%E6%9C%BA%E4%B8%8A%E5%B7%B2%E6%9C%89%E9%95%9C%E5%83%8F><span class=toc-number>1.3.2.1.</span> <span class=toc-text>列出本地主机上已有镜像</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#%E4%BD%BF%E7%94%A8-tag-%E5%91%BD%E4%BB%A4%E6%B7%BB%E5%8A%A0%E9%95%9C%E5%83%8F%E6%A0%87%E7%AD%BE><span class=toc-number>1.3.2.2.</span> <span class=toc-text>使用 tag 命令添加镜像标签</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#%E4%BD%BF%E7%94%A8-inspect-%E5%91%BD%E4%BB%A4%E6%9F%A5%E7%9C%8B%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF><span class=toc-number>1.3.2.3.</span> <span class=toc-text>使用 inspect 命令查看详细信息</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#%E4%BD%BF%E7%94%A8-history-%E5%91%BD%E4%BB%A4%E6%9F%A5%E7%9C%8B%E9%95%9C%E5%83%8F%E5%8E%86%E5%8F%B2><span class=toc-number>1.3.2.4.</span> <span class=toc-text>使用 history 命令查看镜像历史</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#%E5%88%A0%E9%99%A4%E9%95%9C%E5%83%8F><span class=toc-number>1.3.2.5.</span> <span class=toc-text>删除镜像</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#%E6%B8%85%E7%90%86%E9%95%9C%E5%83%8F><span class=toc-number>1.3.2.6.</span> <span class=toc-text>清理镜像</span></a></li></ol></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%88%9B%E5%BB%BA%E9%95%9C%E5%83%8F><span class=toc-number>1.3.3.</span> <span class=toc-text>创建镜像</span></a><ol class=toc-child><li class="toc-item toc-level-4"><a class=toc-link href=#1-%E5%9F%BA%E4%BA%8E%E5%B7%B2%E6%9C%89%E5%AE%B9%E5%99%A8%E5%88%9B%E5%BB%BA><span class=toc-number>1.3.3.1.</span> <span class=toc-text>1. 基于已有容器创建</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#2-%E5%9F%BA%E4%BA%8E-Dockerfile-%E5%88%9B%E5%BB%BA><span class=toc-number>1.3.3.2.</span> <span class=toc-text>2. 基于 Dockerfile 创建</span></a></li></ol></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%AD%98%E5%82%A8%E9%95%9C%E5%83%8F><span class=toc-number>1.3.4.</span> <span class=toc-text>存储镜像</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E8%BD%BD%E5%85%A5%E9%95%9C%E5%83%8F><span class=toc-number>1.3.5.</span> <span class=toc-text>载入镜像</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E4%B8%8A%E4%BC%A0%E9%95%9C%E5%83%8F><span class=toc-number>1.3.6.</span> <span class=toc-text>上传镜像</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E6%93%8D%E4%BD%9C-Docker-%E5%AE%B9%E5%99%A8><span class=toc-number>1.4.</span> <span class=toc-text>操作 Docker 容器</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%90%AF%E5%8A%A8%E5%AE%B9%E5%99%A8><span class=toc-number>1.4.1.</span> <span class=toc-text>启动容器</span></a><ol class=toc-child><li class="toc-item toc-level-4"><a class=toc-link href=#1-%E6%96%B0%E5%BB%BA%E5%B9%B6%E5%90%AF%E5%8A%A8><span class=toc-number>1.4.1.1.</span> <span class=toc-text>1. 新建并启动</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#2-%E5%90%AF%E5%8A%A8%E5%B7%B2%E7%BB%88%E6%AD%A2%E5%AE%B9%E5%99%A8><span class=toc-number>1.4.1.2.</span> <span class=toc-text>2. 启动已终止容器</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#3-%E6%9F%A5%E7%9C%8B%E5%AE%B9%E5%99%A8%E8%BE%93%E5%87%BA><span class=toc-number>1.4.1.3.</span> <span class=toc-text>3. 查看容器输出</span></a></li></ol></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E7%BB%88%E6%AD%A2%E5%AE%B9%E5%99%A8><span class=toc-number>1.4.2.</span> <span class=toc-text>终止容器</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#exec%E8%BF%9B%E5%85%A5%E5%AE%B9%E5%99%A8><span class=toc-number>1.4.3.</span> <span class=toc-text>exec进入容器</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%88%A0%E9%99%A4%E5%AE%B9%E5%99%A8><span class=toc-number>1.4.4.</span> <span class=toc-text>删除容器</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%B8%85%E7%90%86%E6%89%80%E6%9C%89%E5%A4%84%E4%BA%8E%E7%BB%88%E6%AD%A2%E7%8A%B6%E6%80%81%E7%9A%84%E5%AE%B9%E5%99%A8><span class=toc-number>1.4.5.</span> <span class=toc-text>清理所有处于终止状态的容器</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%AF%BC%E5%87%BA%E5%92%8C%E5%AF%BC%E5%85%A5%E5%AE%B9%E5%99%A8><span class=toc-number>1.4.6.</span> <span class=toc-text>导出和导入容器</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%9F%A5%E7%9C%8B%E5%AE%B9%E5%99%A8><span class=toc-number>1.4.7.</span> <span class=toc-text>查看容器</span></a><ol class=toc-child><li class="toc-item toc-level-4"><a class=toc-link href=#1-%E6%9F%A5%E7%9C%8B%E5%AE%B9%E5%99%A8%E8%AF%A6%E6%83%85><span class=toc-number>1.4.7.1.</span> <span class=toc-text>1. 查看容器详情</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#2-%E6%9F%A5%E7%9C%8B%E5%AE%B9%E5%99%A8%E5%86%85%E8%BF%9B%E7%A8%8B><span class=toc-number>1.4.7.2.</span> <span class=toc-text>2. 查看容器内进程</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#3-%E6%9F%A5%E7%9C%8B%E7%BB%9F%E8%AE%A1%E4%BF%A1%E6%81%AF><span class=toc-number>1.4.7.3.</span> <span class=toc-text>3. 查看统计信息</span></a></li></ol></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%9B%B4%E6%96%B0%E9%85%8D%E7%BD%AE><span class=toc-number>1.4.8.</span> <span class=toc-text>更新配置</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E9%87%8D%E5%91%BD%E5%90%8D%E5%AE%B9%E5%99%A8><span class=toc-number>1.4.9.</span> <span class=toc-text>重命名容器</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%9F%A5%E7%9C%8B%E5%AE%B9%E5%99%A8%E6%97%A5%E5%BF%97><span class=toc-number>1.4.10.</span> <span class=toc-text>查看容器日志</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#Portainer-%E5%AE%B9%E5%99%A8%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7><span class=toc-number>1.4.11.</span> <span class=toc-text>Portainer 容器管理工具</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#Docker-%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%8C%96><span class=toc-number>1.5.</span> <span class=toc-text>Docker 数据持久化</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#1-%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%8D%B7><span class=toc-number>1.5.1.</span> <span class=toc-text>1. 创建数据卷</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#2-%E7%BB%91%E5%AE%9A%E6%95%B0%E6%8D%AE%E5%8D%B7><span class=toc-number>1.5.2.</span> <span class=toc-text>2. 绑定数据卷</span></a><ol class=toc-child><li class="toc-item toc-level-4"><a class=toc-link href=#mount><span class=toc-number>1.5.2.1.</span> <span class=toc-text>--mount</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#v%EF%BC%8C-volume><span class=toc-number>1.5.2.2.</span> <span class=toc-text>-v，--volume</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#Dockerfile><span class=toc-number>1.6.</span> <span class=toc-text>Dockerfile</span></a></li></ol></li><li class="toc-item toc-level-1"><a class=toc-link href=#%E5%BA%94%E7%94%A8%E5%AE%89%E8%A3%85><span class=toc-number>2.</span> <span class=toc-text>应用安装</span></a><ol class=toc-child><li class="toc-item toc-level-2"><a class=toc-link href=#GitLab-%E5%8F%8A%E5%85%B6%E5%AE%98%E6%96%B9%E9%95%9C%E5%83%8F><span class=toc-number>2.1.</span> <span class=toc-text>GitLab 及其官方镜像</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#docker-compose-yml><span class=toc-number>2.1.1.</span> <span class=toc-text>docker-compose.yml</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E8%BF%90%E8%A1%8C%E5%AE%B9%E5%99%A8><span class=toc-number>2.1.2.</span> <span class=toc-text>运行容器</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%9B%B4%E6%96%B0-gitlab><span class=toc-number>2.1.3.</span> <span class=toc-text>更新 gitlab</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%BE%85%E5%AE%9E%E8%B7%B5><span class=toc-number>2.2.</span> <span class=toc-text>待实践</span></a></li></ol></li><li class="toc-item toc-level-1"><a class=toc-link href=#Docker-%E7%9B%B8%E5%85%B3%E7%9A%84%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1><span class=toc-number>3.</span> <span class=toc-text>Docker 相关的定时任务</span></a></li><li class="toc-item toc-level-1"><a class=toc-link href=#%E6%89%A9%E5%B1%95%E9%98%85%E8%AF%BB><span class=toc-number>4.</span> <span class=toc-text>扩展阅读</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class=item-headline><i class="fas fa-history"></i><span>最新文章</span></div><div class=aside-list><div class=aside-list-item><a class=thumbnail href=/48e2be28f51c/ title=马斯克开源的推特推荐算法是什么？><img src=https://cdn.jsdelivr.net/gh/youngjuning/images@main/1680332408977.png onerror='this.onerror=null,this.src="/img/404.jpg"' alt=马斯克开源的推特推荐算法是什么？></a><div class=content><a class=title href=/48e2be28f51c/ title=马斯克开源的推特推荐算法是什么？>马斯克开源的推特推荐算法是什么？</a><time datetime=2023-04-01T06:50:59.000Z title="发表于 2023-04-01 14:50:59">2023-04-01</time></div></div><div class=aside-list-item><a class=thumbnail href=/11f99a2c1dec/ title="睡觉也能赚钱! GoSleep ARB 上首款睡眠 App"><img src=https://cdn.jsdelivr.net/gh/youngjuning/images@main/1680317979482.png onerror='this.onerror=null,this.src="/img/404.jpg"' alt="睡觉也能赚钱! GoSleep ARB 上首款睡眠 App"></a><div class=content><a class=title href=/11f99a2c1dec/ title="睡觉也能赚钱! GoSleep ARB 上首款睡眠 App">睡觉也能赚钱! GoSleep ARB 上首款睡眠 App</a><time datetime=2023-04-01T02:55:37.000Z title="发表于 2023-04-01 10:55:37">2023-04-01</time></div></div><div class=aside-list-item><a class=thumbnail href=/e9a681ea0422/ title="「已解决」Antd Table columns fixed 不生效"><img src=https://cdn.pixabay.com/photo/2023/02/04/07/50/flower-7766608_1280.jpg onerror='this.onerror=null,this.src="/img/404.jpg"' alt="「已解决」Antd Table columns fixed 不生效"></a><div class=content><a class=title href=/e9a681ea0422/ title="「已解决」Antd Table columns fixed 不生效">「已解决」Antd Table columns fixed 不生效</a><time datetime=2023-03-31T03:24:13.000Z title="发表于 2023-03-31 11:24:13">2023-03-31</time></div></div><div class=aside-list-item><a class=thumbnail href=/25919c20aa71/ title="什么是 CPA"><img src=https://cdn.jsdelivr.net/gh/youngjuning/images@main/1680229234742.png onerror='this.onerror=null,this.src="/img/404.jpg"' alt="什么是 CPA"></a><div class=content><a class=title href=/25919c20aa71/ title="什么是 CPA">什么是 CPA</a><time datetime=2023-03-30T13:11:30.000Z title="发表于 2023-03-30 21:11:30">2023-03-30</time></div></div><div class=aside-list-item><a class=thumbnail href=/632d3a121d65/ title="Hexo × Github 免费搭建联盟营销独立站"><img src=https://cdn.pixabay.com/photo/2023/02/08/15/10/sculpture-7776861_1280.jpg onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Hexo × Github 免费搭建联盟营销独立站"></a><div class=content><a class=title href=/632d3a121d65/ title="Hexo × Github 免费搭建联盟营销独立站">Hexo × Github 免费搭建联盟营销独立站</a><time datetime=2023-03-29T11:05:04.000Z title="发表于 2023-03-29 19:05:04">2023-03-29</time></div></div></div></div><div class="card-widget ads-wrap"><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-7962287588031867 data-ad-slot=1257383027 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div></div></main><footer id=footer style=background-image:url(https://i.loli.net/2020/03/31/UI9JSTCENRvqDwY.png)><div id=footer-wrap><div class=copyright>&copy;2020 - 2023 By 洛竹</div><div class=framework-info><span>框架 </span><a target=_blank rel="noopener external nofollow noreferrer" href=https://hexo.io>Hexo</a><span class=footer-separator>|</span><span>主题 </span><a target=_blank rel="noopener external nofollow noreferrer" href=https://github.com/jerryc127/hexo-theme-butterfly>Butterfly</a></div></div></footer></div><div id=rightside><div id=rightside-config-hide><button id=readmode type=button title=阅读模式><i class="fas fa-book-open"></i></button><button id=translateLink type=button title=简繁转换>繁</button><button id=darkmode type=button title=浅色和深色模式转换><i class="fas fa-adjust"></i></button><button id=hide-aside-btn type=button title=单栏和双栏切换><i class="fas fa-arrows-alt-h"></i></button></div><div id=rightside-config-show><button id=rightside_config type=button title=设置><i class="fas fa-cog fa-spin"></i></button><button class=close id=mobile-toc-button type=button title=目录><i class="fas fa-list-ul"></i></button><a id=to_comment href=#post-comment title=直达评论><i class="fas fa-comments"></i></a><button id=go-up type=button title=回到顶部><span class=scroll-percent></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src=https://cdn.jsdelivr.net/gh/youngjuning/youngjuning.github.io@gh-pages/js/utils.js></script><script src=https://cdn.jsdelivr.net/gh/youngjuning/youngjuning.github.io@gh-pages/js/main.js></script><script src=https://cdn.jsdelivr.net/gh/youngjuning/youngjuning.github.io@gh-pages/js/tw_cn.js></script><script src=https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js></script><script src=https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js></script><script>function panguFn(){"object"==typeof pangu?pangu.autoSpacingPage():getScript("https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js").then(()=>{pangu.autoSpacingPage()})}function panguInit(){panguFn()}document.addEventListener("DOMContentLoaded",panguInit)</script><div class=js-pjax><script>(()=>{const e=document.querySelectorAll("#article-container .mermaid-wrap");var t;e.length&&(window.runMermaid=()=>{window.loadMermaid=!0;const n="dark"===document.documentElement.getAttribute("data-theme")?"dark":"default";Array.from(e).forEach((e,t)=>{const d=e.firstElementChild;e="%%{init:{ 'theme':'"+n+"'}}%%\n"+d.textContent;mermaid.mermaidAPI.render("mermaid-"+t,e,e=>{d.insertAdjacentHTML("afterend",e)})})},t=()=>{window.loadMermaid?runMermaid():getScript("https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js").then(runMermaid)},window.pjax?t():document.addEventListener("DOMContentLoaded",t))})()</script><script>function loadGiscus(){var t,e="dark"===document.documentElement.getAttribute("data-theme")?"dark":"light",a=Object.assign({src:"https://giscus.app/client.js","data-repo":"youngjuning/youngjuning.github.io","data-repo-id":"R_kgDOGFxZtw","data-category-id":"DIC_kwDOGFxZt84CUMwP","data-mapping":"pathname","data-theme":e,"data-reactions-enabled":"1",crossorigin:"anonymous",async:!0},{"data-mapping":"og:title","data-lang":"zh-CN","data-input-position":"top"}),n=document.createElement("script");for(t in a)n.setAttribute(t,a[t]);document.getElementById("giscus-wrap").insertAdjacentElement("afterbegin",n)}function changeGiscusTheme(){var t,e="dark"===document.documentElement.getAttribute("data-theme")?"dark":"light";e={setConfig:{theme:e}},(t=document.querySelector("iframe.giscus-frame"))&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")}function loadOtherComment(){loadGiscus()}loadGiscus()</script><script>function loadLivere(){var e,t,o;"object"==typeof LivereTower?window.LivereTower.init():(e=document,t="script",o=e.getElementsByTagName(t)[0],"function"!=typeof LivereTower&&((e=e.createElement(t)).src="https://cdn-city.livere.com/js/embed.dist.js",e.async=!0,o.parentNode.insertBefore(e,o)))}function loadOtherComment(){loadLivere()}loadLivere()</script></div><canvas class=fireworks mobile=false></canvas><script src=https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js></script><script defer=defer id=fluttering_ribbon mobile=false src=https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js></script><script src=https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!0,POWERMODE.mobile=!1,document.body.addEventListener("input",POWERMODE)</script><script id=click-heart src=https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js async=async mobile=false></script><script src=https://cdn.jsdelivr.net/npm/pjax/pjax.min.js></script><script>let pjaxSelectors=['link[rel="canonical"]','meta[property="og:image"]','meta[property="og:title"]','meta[property="og:url"]',"head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!0,scrollRestoration:!1});document.addEventListener("pjax:send",function(){if(window.tocScrollFn&&window.removeEventListener("scroll",window.tocScrollFn),window.scrollCollect&&window.removeEventListener("scroll",scrollCollect),document.getElementById("rightside").style.cssText="opacity: ''; transform: ''",window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();var e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode"),"object"==typeof disqusjs&&disqusjs.destroy()}),document.addEventListener("pjax:complete",function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach(e=>{const t=document.createElement("script");var o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach(e=>t.setAttribute(e.name,e.value)),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)}),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof chatBtnFn&&chatBtnFn(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","G-M7KEMBRVPJ",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll()}),document.addEventListener("pjax:error",e=>{404===e.request.status&&pjax.loadUrl("/404.html")})</script><script async data-pjax src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script></div><div id=local-search><div class=search-dialog><nav class=search-nav><span class=search-dialog-title>搜索</span><span id=loading-status></span><button class=search-close-button><i class="fas fa-times"></i></button></nav><div class=is-center id=loading-database><i class="fas fa-spinner fa-pulse"></i><span> 数据库加载中</span></div><div class=search-wrap><div id=local-search-input><div class=local-search-box><input class=local-search-box--input placeholder=搜索文章 type=text></div></div><hr><div id=local-search-results></div></div></div><div id=search-mask></div><script src=https://cdn.jsdelivr.net/gh/youngjuning/youngjuning.github.io@gh-pages/js/search/local-search.js></script></div><script data-pjax>function butterfly_swiper_injector_config(){var l=document.getElementById("recent-posts");console.log("已挂载butterfly_swiper"),l.insertAdjacentHTML("afterbegin",'<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;f6093e483bf0/&quot;);" href="javascript:void(0);" rel="external nofollow noreferrer" alt=""><img width="48" height="48" src="https://cdn.jsdelivr.net/gh/youngjuning/images@main/1679280067130.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-03-19</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;f6093e483bf0/&quot;);" href="javascript:void(0);" rel="external nofollow noreferrer" alt="">Go 语言教程系列の介绍和环境安装</a><div class="blog-slider__text">这是我们 Golang 教程系列中的第一篇教程。本教程介绍了 Go，并讨论了选择 Go 而不是其他编程语言的原因。我们还将学习如何在 Mac OS，Windows 和 Linux 中安装 Go。</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;f6093e483bf0/&quot;);" href="javascript:void(0);" rel="external nofollow noreferrer" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;d744d1d3d1e8/&quot;);" href="javascript:void(0);" rel="external nofollow noreferrer" alt=""><img width="48" height="48" src="https://cdn.pixabay.com/photo/2023/02/06/16/46/sea-7772372_1280.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-02-06</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;d744d1d3d1e8/&quot;);" href="javascript:void(0);" rel="external nofollow noreferrer" alt="">OpenAI 推出超神 ChatGPT 注册攻略来了</a><div class="blog-slider__text">OpenAI 推出超神 ChatGPT，非常火爆。但是呢，由于 ChatGPT 注册的问题，大部分人无法体验到。这里我分享一下我的国内 ChatGPT 注册攻略。</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;d744d1d3d1e8/&quot;);" href="javascript:void(0);" rel="external nofollow noreferrer" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;cb03d5cd6dce/&quot;);" href="javascript:void(0);" rel="external nofollow noreferrer" alt=""><img width="48" height="48" src="https://cdn.pixabay.com/photo/2023/02/06/01/14/superb-fairywren-7770904_1280.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-01-31</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;cb03d5cd6dce/&quot;);" href="javascript:void(0);" rel="external nofollow noreferrer" alt="">2023 年度计划</a><div class="blog-slider__text">计划赶不上变化，但是变化也不会赶上计划。</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;cb03d5cd6dce/&quot;);" href="javascript:void(0);" rel="external nofollow noreferrer" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;db7a22999938/&quot;);" href="javascript:void(0);" rel="external nofollow noreferrer" alt=""><img width="48" height="48" src="https://cdn.pixabay.com/photo/2023/02/08/15/10/sculpture-7776861_1280.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-11-02</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;db7a22999938/&quot;);" href="javascript:void(0);" rel="external nofollow noreferrer" alt="">2023 常用 NPM 包推荐</a><div class="blog-slider__text">帮助开发者从 NPM 包选型的角度感知和建立前端工程化体系。</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;db7a22999938/&quot;);" href="javascript:void(0);" rel="external nofollow noreferrer" alt="">详情       </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>')}for(var elist="undefined".split(","),cpage=location.pathname,epage="all",flag=0,i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;("all"===epage&&0==flag||epage===cpage)&&butterfly_swiper_injector_config()</script><script defer=defer src=https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js></script><script defer=defer data-pjax src=https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js></script></body></html>